:_mod-docs-content-type: ASSEMBLY
[id="virt-4-20-release-notes"]
= {VirtProductName} release notes
include::_attributes/common-attributes.adoc[]
:context: virt-4-20-release-notes

toc::[]

[id="virt-doc-feedback_{context}"]
== Providing documentation feedback

To report an error or to improve our documentation, log in to your link:https://issues.redhat.com[Red Hat Jira account] and submit a link:https://issues.redhat.com/secure/CreateIssueDetails!init.jspa?pid=12323181&issuetype=1&components=12333768&priority=10200&summary=%5BDoc%5D&customfield_12316142[Jira issue].

[id="virt-about-virt_{context}"]
== About Red Hat {VirtProductName}

With Red Hat {VirtProductName}, you can bring traditional virtual machines (VMs) into {product-title} and run them alongside containers. In {VirtProductName}, VMs are native Kubernetes objects that you can manage by using the {product-title} web console or the command line.

{VirtProductName} is represented by the image:virt-icon.png[{VirtProductName},40,40] icon.

You can use {VirtProductName} the xref:../../networking/ovn_kubernetes_network_provider/about-ovn-kubernetes.adoc#about-ovn-kubernetes[OVN-Kubernetes] Container Network Interface (CNI) network provider.

Learn more about xref:../../virt/about_virt/about-virt.adoc#about-virt[what you can do with {VirtProductName}].

Learn more about xref:../../virt/about_virt/virt-architecture.adoc#virt-architecture[{VirtProductName} architecture and deployments].

xref:../../virt/install/preparing-cluster-for-virt.adoc#preparing-cluster-for-virt[Prepare your cluster] for {VirtProductName}.

include::modules/virt-supported-cluster-version.adoc[leveloffset=+2]


[id="virt-guest-os_{context}"]
=== Supported guest operating systems

To view the supported guest operating systems for {VirtProductName}, see link:https://access.redhat.com/articles/973163#ocpvirt[Certified Guest Operating Systems in Red Hat OpenStack Platform, Red Hat Virtualization, OpenShift Virtualization and Red Hat Enterprise Linux with KVM].

//Ensure platform passes Windows Server Virtualization Validation Program. Otherwise, comment out the section below.
[id="virt-svvp-certification_{context}"]
=== Microsoft Windows SVVP certification

//CNV-47134 SVVP 4.18 Release Note: New
//NOTE: This is a recurring release note. Modify the existing note text below if recommended by QE.
{VirtProductName} is certified in Microsoft's Windows Server Virtualization Validation Program (SVVP) to run Windows Server workloads.

The SVVP certification applies to:

* Red Hat Enterprise Linux CoreOS workers. In the Microsoft SVVP Catalog, they are named __Red Hat OpenShift Container Platform 4 on RHEL CoreOS 9__.
* Intel and AMD CPUs.

[id="virt-quick-starts_{context}"]
== Quick starts

Quick start tours are available for several {VirtProductName} features. To view the tours, click the *Help* icon *?* in the menu bar on the header of the {product-title} web console and then select *Quick Starts*. You can filter the available tours by entering the keyword `virtualization` in the *Filter* field.


[id="virt-4-20-new_{context}"]
== New and changed features

This release adds new features and enhancements related to the following components and concepts:

[id="virt-4-20-installation-update_{context}"]
=== Installation and update

//CNV-43322 Release notes:TP to GA OCI
* Installing {VirtProductName} on {oci-first-no-rt} is now generally available. For more information, see link:https://access.redhat.com/articles/7118050[{VirtProductName} and Oracle Cloud Infrastructure known issues and limitations] in the Red{nbsp}Hat Knowledgebase, and link:https://github.com/oracle-quickstart/oci-openshift/blob/main/docs/openshift-virtualization.md[Installing {VirtProductName} on OCI] on GitHub.

[id="virt-4-20-infrastructure_{context}"]
=== Infrastructure

[id="virt-4-20-virtualization_{context}"]
=== Virtualization

[id="virt-4-20-networking_{context}"]
=== Networking

//CNV-62387
* You can now hot plug and hot unplug a secondary network interface to a VM without manually triggering live migration. You do not need permission to create and list `VirtualMachineInstanceMigration` objects. For more information, see xref:../../virt/vm_networking/virt-hot-plugging-network-interfaces.adoc#virt-hot-plugging-bridge-network-interface_virt-hot-plugging-network-interfaces[Hot plugging secondary network interfaces].

//CNV-52857 and CNV-56324
* xref:../../virt/vm_networking/virt-setting-interface-link-state.adoc#virt-setting-interface-link-state[Managing the link state of a virtual machine interface] is now generally available. In previous releases this was a Technology Preview feature.

[id="virt-4-20-storage_{context}"]
=== Storage

[id="virt-4-20-web_{context}"]
=== Web console
//CNV-62026
* In the {product-title} web console, the *Migrations* tab of the *Virtualization* page now displays a progress bar for each migrating virtual machine.

//CNV-63497
* When performing live migration of a VM, you can now xref:../../virt/live_migration/virt-initiating-live-migration.adoc#virt-initiating-vm-migration-web_virt-initiating-live-migration[specify the particular node for the VM to migrate to.]

[id="virt-4-20-monitoring_{context}"]
=== Monitoring
//CNV-63662
* Added documentation for the `kubevirt_vmi_vcpu_delay_seconds_total` Prometheus metric. This metric reports the time a virtual CPU (vCPU) was queued by the host scheduler but was not running. The updated documentation helps users better understand vCPU queue delays in OpenShift Virtualization environments.

//CNV-59719
* The following link:https://docs.redhat.com/en/documentation/openshift_container_platform/4.19/html/virtualization/monitoring#virt-runbooks[alerts for the OpenShift Virtualization Operator] are now included in the OpenShift Container Platform runbooks: 

** `HighNodeCPUFrequency`
** `VirtualMachineStuckInUnhealthyState`
** `VirtualMachineStuckOnNode`
** `PersistentVolumeFillingUp`
** `DeprecatedMachineType`
** `HCOGoldenImageWithNoSupportedArchitecture`
** `HCOGoldenImageWithNoArchitectureAnnotation`
** `HCOMultiArchGoldenImagesDisabled`

For a complete list of virtualization metrics, see link:https://github.com/kubevirt/monitoring/blob/main/docs/metrics.md[KubeVirt components metrics]. 

[id="virt-4-20-documentation_{context}"]
=== Documentation improvements

[id="virt-4-20-notable-technical-changes_{context}"]
=== Notable technical changes


[id="virt-4-20-deprecated-removed_{context}"]
== Deprecated and removed features

[id="virt-4-20-deprecated_{context}"]
=== Deprecated features
// NOTE: When uncommenting deprecated features list, change the Removed features header level below to ===

Deprecated features are included in the current release and supported. However, they will be removed in a future release and are not recommended for new deployments.

* The `OperatorConditionsUnhealthy` alert is deprecated. You can safely xref:../../observability/monitoring/managing-alerts/managing-alerts-as-an-administrator.adoc#silencing-alerts-adm_managing-alerts-as-an-administrator[silence] it.

[id="virt-4-20-removed_{context}"]
=== Removed features

Removed features are no longer supported in {VirtProductName}.

//CNV-62385
* With this release, support for the Data Plane Development Kit (DPDK) checkup has been removed. You can no longer run a predefined checkup to verify if your {product-title} cluster node can run a VM with a DPDK workload with zero packet loss.

[id="virt-4-20-technology-preview_{context}"]
== Technology Preview features

Some features in this release are currently in Technology Preview. These experimental features are not intended for production use. Note the following scope of support on the Red Hat Customer Portal for these features:

link:https://access.redhat.com/support/offerings/techpreview[Technology Preview Features Support Scope]

//CNV-58005
* {VirtProductName} is now supported on link:https://learn.microsoft.com/en-us/azure/azure-boost/overview[Azure Boost].

// CNV-58423
* The `DevKubeVirtRelieveAndMigrate` descheduler profile is xref:../../virt/managing_vms/advanced_vm_management/virt-enabling-descheduler-evictions.adoc#nodes-descheduler-profiles_virt-enabling-descheduler-evictions[now available]. This profile enhances the `LongLifecycle` profile by supporting load-aware descheduling, dynamic soft taints, and improved workload rebalancing.

[id="virt-4-20-bug-fixes_{context}"]
== Bug fixes


[id="virt-4-20-known-issues_{context}"]
== Known issues

[discrete]
[id="virt-4-20-ki-monitoring_{context}"]
=== Monitoring

[discrete]
[id="virt-4-20-ki-networking_{context}"]
=== Networking

//CNV-38746: According to Petr, this will remain relevant as long as 4.12 is available. Anyone upgrading from 4.12 could be affected. Version 4.12 is supported until January 2026
* When you update from {product-title} 4.12 to a newer minor version, VMs that use the `cnv-bridge` Container Network Interface (CNI) fail to live migrate. (link:https://access.redhat.com/solutions/7069807[])
** As a workaround, change the `spec.config.type` field in your `NetworkAttachmentDefinition` manifest from `cnv-bridge` to `bridge` before performing the update.


[discrete]
[id="virt-4-20-ki-nodes_{context}"]
==== Nodes

//CNV-38543: According to Stu, this remains an issue in 4.20
* Uninstalling {VirtProductName} does not remove the `feature.node.kubevirt.io` node labels created by {VirtProductName}. You must remove the labels manually. (link:https://issues.redhat.com/browse/CNV-38543[*CNV-38543*])

[discrete]
[id="virt-4-20-ki-storage_{context}"]
==== Storage

//CNV-61279: 4.19 - Storage Migrate VM with MTC
* Restoring a snapshot of a virtual machine (VM) migrated using Migration Toolkit for Containers (MTC) fails. The restore creates a persistent volume claim (PVC) but not a data volume (DV). The VM spec references a `DataVolumeTemplate` missing from the `volumes` list. (link:https://issues.redhat.com/browse/CNV-61279[*CNV-61279*])
** As a workaround, restart the VM after storage migration and before taking the snapshot. This creates a new controller revision that avoids the issue.

// CNV-55104: 4.18 - Unresolved
* If you perform storage class migration for a stopped VM, the VM might not be able to start because of a missing bootable device. To prevent this, do not attempt storage class migration if the VM is not running. (link:https://issues.redhat.com/browse/CNV-55104[*CNV-55104*])
+
--
:FeatureName: Storage class migration
include::snippets/technology-preview.adoc[]
--

[discrete]
[id="virt-4-20-ki-virtualization_{context}"]
=== Virtualization

//CNV-48348
* When the mode of live migration is *PostCopy*, hot-plugging CPU or memory resource fails. (link:https://issues.redhat.com/browse/CNV-48348[*CNV-48348*])

//CNV-33835: Per German, this was targeted for 4.20 but moved to 4.21 (see also CNV-27131)
* {VirtProductName} links a service account token in use by a pod to that specific pod. {VirtProductName} implements a service account volume by creating a disk image that contains a token. If you migrate a VM, then the service account volume becomes invalid. (link:https://issues.redhat.com/browse/CNV-33835[*CNV-33835*])
** As a workaround, use user accounts rather than service accounts because user account tokens are not bound to a specific pod.

//CNV-36448
* When adding a virtual Trusted Platform Module (vTPM) device to a Windows VM, the BitLocker Drive Encryption system check passes even if the vTPM device is not persistent. This is because a vTPM device that is not persistent stores and recovers encryption keys using ephemeral storage for the lifetime of the virt-launcher pod. When the VM migrates or is shut down and restarts, the vTPM data is lost. (link:https://issues.redhat.com/browse/CNV-36448[CNV-36448])

[discrete]
[id="virt-4-20-ki-webconsole_{context}"]
=== Web console

[discrete]
[id="virt-4-20-ki-ibm-z_{context}"]
=== {ibm-z-title} and {ibm-linuxone-title}

ifdef::openshift-enterprise[]
:FeatureName: Using {VirtProductName} in a cluster deployed on s390x architecture
include::snippets/technology-preview.adoc[]
:!FeatureName:
endif::[]

// cnv-61740 - s390x VM fails to boot with SATA CD-ROM
* If you create a VM from a template and select *Boot from CD*, the VM fails to boot and the error `unsupported configuration: SATA is not supported with this QEMU binary` is logged. This occurs because the CD-ROM is automatically mounted as a SATA device, which is not supported on s390x architecture. (link:https://issues.redhat.com/browse/CNV-61740[CNV-61740])
** As a workaround, navigate to the VM's *Configuration* ->  *Storage* tab, select the CD-ROM, and change the interface type from *SATA* to *SCSI*.

// cnv-61957 - GPU devices should not be shown in UI
* GPU devices appear in the *Hardware Devices* list for s390x VMs, but GPU support is not available for s390x architecture. You can disregard these list entries. (link:https://issues.redhat.com/browse/CNV-61957[CNV-61957])

// ocpbugs-51113 - ballooning call traces
* When you create a VM by using {op-system-base-full} container disk images for s390x architecture, call traces referencing `virtio_balloon` free page reporting print to the VM console. This is due to a kernel bug. (link:https://issues.redhat.com/browse/OCPBUGS-51113[OCPBUGS-51113])
** As a workaround, disable memory ballooning for the VM by adding the following parameter to the VM YAML configuration: `spec.domain.devices.autoattachMemBalloon: false`.
+
You can also disable free page reporting of memory ballooning for all new VMs. To do so, edit the `HyperConverged` CR and add the parameter `spec.virtualMachineOptions.disableFreePageReporting: true`.

// cnv-56889 - boot mode
* VMs based on s390x architecture can only use the *IPL* boot mode. However, in the {product-title} web console, the *Boot mode* list for s390x VMs incorrectly includes *BIOS*, *UEFI*, and *UEFI (secure)* boot modes. If you select one of these modes for an s390x-based VM, the operation fails. (link:https://issues.redhat.com/browse/CNV-56889[CNV-56889])

// cnv-56890 - threads
* In the {product-title} web console, it is erroneously possible to define multiple CPU threads for a VM based on s390x architecture. If you define multiple CPU threads, the VM enters a `CrashLoopBackOff` state with the `qemu-kvm: S390 does not support more than 1 threads` error. (link:https://issues.redhat.com/browse/CNV-56890[CNV-56890])
